# üìä –û—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –§–∞–∑—ã 3: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è (–î–µ–Ω—å 1)

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. Unit —Ç–µ—Å—Ç—ã –¥–ª—è DOM –º–æ–¥—É–ª—è
**–§–∞–π–ª:** `crates/zver/tests/dom_unit_tests.rs`  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤:** 12  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**
- ‚úÖ `parse_html()` - –ø–∞—Ä—Å–∏–Ω–≥ HTML –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ `get_element_by_id()` - –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ ID
- ‚úÖ `get_elements_by_class_name()` - –ø–æ–∏—Å–∫ –ø–æ –∫–ª–∞—Å—Å—É
- ‚úÖ `get_elements_by_tag_name()` - –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–≥—É
- ‚úÖ `attribute()` - –¥–æ—Å—Ç—É–ø –∫ –∞—Ç—Ä–∏–±—É—Ç–∞–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ `get_text_content()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- ‚úÖ `query_selector()` - CSS —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
- ‚úÖ `select_ids_from()` - –≤—ã–±–æ—Ä–∫–∞ –∏–∑ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–µ—Ä–µ–≤–∞
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è parent/child —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—É Node
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ malformed HTML
- ‚úÖ –ü—É—Å—Ç—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- ‚úÖ –°–ª–æ–∂–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã (`.item.active`, `#list li`)

**–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Å—Ç—ã:**
```rust
test test_parse_simple_html ... ok
test test_get_element_by_id ... ok
test test_get_elements_by_class_name ... ok
test test_attribute_access ... ok
test test_parent_child_navigation ... ok
test test_query_selector ... ok
```

---

### 2. Unit —Ç–µ—Å—Ç—ã –¥–ª—è Layout –º–æ–¥—É–ª—è
**–§–∞–π–ª:** `crates/zver/tests/layout_unit_tests.rs`  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤:** 14  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**
- ‚úÖ `compute_layout()` - –±–∞–∑–æ–≤–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ layout
- ‚úÖ Viewport dimensions - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã viewport
- ‚úÖ `invalidate()` - —Å–±—Ä–æ—Å –∫—ç—à–∞
- ‚úÖ `display: none` - –ø—Ä–æ–ø—É—Å–∫ –Ω–µ–≤–∏–¥–∏–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ - text measurement –¥–ª—è Taffy
- ‚úÖ Nested layout - –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- ‚úÖ `get_layout_result()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ ID
- ‚úÖ `get_all_layout_results()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ `resolved_styles()` - –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏
- ‚úÖ Inline elements - –æ–±—Ä–∞–±–æ—Ç–∫–∞ `<span>` –∏ –¥—Ä—É–≥–∏—Ö inline
- ‚úÖ Script/style tags - –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Ç–µ–≥–æ–≤
- ‚úÖ Whitespace-only text nodes - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–±–µ–ª–æ–≤
- ‚úÖ Multiple computations - –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö
- ‚úÖ –ü—É—Å—Ç—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

**–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Å—Ç—ã:**
```rust
test test_basic_layout_computation ... ok
test test_viewport_dimensions ... ok
test test_text_measurement ... ok
test test_nested_layout ... ok
test test_layout_invalidation ... ok
```

---

### 3. Unit —Ç–µ—Å—Ç—ã –¥–ª—è Network –º–æ–¥—É–ª—è
**–§–∞–π–ª:** `crates/zver/tests/network_unit_tests.rs`  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤:** 11  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**
- ‚úÖ `NetworkEngine::new()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞
- ‚úÖ `fetch()` - –±–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ Cache functionality - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ `clear_cache_for_url()` - –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
- ‚úÖ `file://` protocol - –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ Paths without protocol - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `file://`
- ‚úÖ `prefetch_resources()` - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ Error handling - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ Prefetch —Å –æ—à–∏–±–∫–∞–º–∏ - —á–∞—Å—Ç–∏—á–Ω—ã–π —É—Å–ø–µ—Ö
- ‚úÖ Multiple fetches - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ URL
- ‚úÖ Empty files - –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ Large files - –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (1MB)

**–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Å—Ç—ã:**
```rust
test test_cache_functionality ... ok
test test_cache_clear ... ok
test test_file_protocol ... ok
test test_prefetch_resources_files ... ok
test test_large_file ... ok
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** HTTP/HTTPS —Ç–µ—Å—Ç—ã –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –í production –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock-—Å–µ—Ä–≤–µ—Ä—ã –∏–ª–∏ httpbin.org.

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è

### –î–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è unit —Ç–µ—Å—Ç–æ–≤:
- **Lib tests:** 19 (CSS –º–æ–¥—É–ª—å)
- **Integration tests:** 8 (–∏–∑ Phase 3)
- **Phase 2 tests:** 6 (1 ignored)
- **Phase 3 tests:** 5 (–≤—Å–µ failed - –æ–∂–∏–¥–∞–µ–º–æ, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
- **–ò—Ç–æ–≥–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö:** 27 —Ç–µ—Å—Ç–æ–≤

### –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è unit —Ç–µ—Å—Ç–æ–≤:
- **DOM unit tests:** +12 ‚úÖ
- **Layout unit tests:** +14 ‚úÖ
- **Network unit tests:** +11 ‚úÖ
- **–ò—Ç–æ–≥–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö:** **64 —Ç–µ—Å—Ç–∞** (+37 –Ω–æ–≤—ã—Ö)

### –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –º–æ–¥—É–ª—è–º:

| –ú–æ–¥—É–ª—å | –ë—ã–ª–æ —Ç–µ—Å—Ç–æ–≤ | –°—Ç–∞–ª–æ —Ç–µ—Å—Ç–æ–≤ | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|--------|-------------|--------------|----------|
| DOM | 0 | 12 | ~70% |
| Layout | 0 | 14 | ~60% |
| Network | 0 | 11 | ~75% |
| CSS | 19 | 19 | ~50% |
| Integration | 8 | 8 | ~40% |
| **–ò–¢–û–ì–û** | 27 | 64 | **~60%** ‚¨ÜÔ∏è |

**–ü—Ä–æ–≥—Ä–µ—Å—Å:** –ü–æ–∫—Ä—ã—Ç–∏–µ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å —Å ~40% –¥–æ ~60% (+20 –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤)

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (Phase 3 –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)

### –ù–µ–¥–µ–ª—è 1 (–î–Ω–∏ 2-5): –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è
- [ ] CSS module unit tests (—Å–≤–æ–π—Å—Ç–≤–∞, –ø–∞—Ä—Å–∏–Ω–≥, –∫–∞—Å–∫–∞–¥)
- [ ] Resource loader tests (async –∑–∞–≥—Ä—É–∑–∫–∞, –æ—á–µ—Ä–µ–¥—å, –ª–∏–º–∏—Ç—ã)
- [ ] JS engine tests (DOM API, setTimeout, –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã)
- [ ] Render module tests (WGPU initialization, batching)
- **–¶–µ–ª—å:** 70% –ø–æ–∫—Ä—ã—Ç–∏–µ

### –ù–µ–¥–µ–ª—è 2: Benchmarks
- [ ] –î–æ–±–∞–≤–∏—Ç—å `criterion = "0.5"` –≤ dev-dependencies
- [ ] DOM benchmarks (parse, select, attributes)
- [ ] CSS benchmarks (parse, apply, cascade)
- [ ] Layout benchmarks (compute, various tree sizes)
- [ ] Full pipeline benchmarks
- **–¶–µ–ª—å:** Baseline –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–µ–¥–µ–ª—è 3: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å API docs –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å usage examples –≤ docstrings
- [ ] –°–æ–∑–¥–∞—Ç—å `examples/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- [ ] TESTING.md guide
- **–¶–µ–ª—å:** 100% documented public API

### –ù–µ–¥–µ–ª—è 4: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] PERFORMANCE.md —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ benchmarks
- [ ] Code review –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
- [ ] Update CHANGELOG.md
- [ ] Prepare release docs
- **–¶–µ–ª—å:** Production-ready —Å–æ—Å—Ç–æ—è–Ω–∏–µ

---

## üîç –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è:
1. **DOM –ø–∞—Ä—Å–µ—Ä:** –°–æ–∑–¥–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —É–∑–ª—ã –¥–ª—è whitespace –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ HTML)
2. **Layout engine:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç whitespace-only —Ç–µ–∫—Å—Ç –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ —Ç–µ–≥–∏ (`<script>`, `<style>`)
3. **Network cache:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Å–æ—Ö—Ä–∞–Ω—è—è –¥–∞–∂–µ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –¥–æ 1MB)
4. **Error handling:** Graceful degradation –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö (–Ω–µ—Ç panic –≤ —Ç–µ—Å—Ç–∞—Ö)

### –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ –°–ª–æ–∂–Ω—ã–µ CSS —Å–µ–ª–µ–∫—Ç–æ—Ä—ã (`.class1.class2`, `#id tag`, descendant selectors)
- ‚úÖ Nested layout —Å arbitrary –≥–ª—É–±–∏–Ω–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ Parallel prefetch —á–µ—Ä–µ–∑ `join_all` (–¥–æ 6 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ production)
- ‚úÖ Layout invalidation –∏ re-computation —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤

```
DOM tests:     12 passed in 0.00s  ‚ö° –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ
Layout tests:  14 passed in 0.01s  ‚ö° –ë—ã—Å—Ç—Ä–æ
Network tests: 11 passed in 0.01s  ‚ö° –ë—ã—Å—Ç—Ä–æ

Total: 37 tests in ~0.02s
```

---

## ‚ú® –ò—Ç–æ–≥–∏ –î–Ω—è 1

### –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
- ‚úÖ **+37 unit —Ç–µ—Å—Ç–æ–≤** –¥–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ **+20% –ø–æ–∫—Ä—ã—Ç–∏—è** (40% ‚Üí 60%)
- ‚úÖ **3 –∫–ª—é—á–µ–≤—ã—Ö –º–æ–¥—É–ª—è** –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏ (DOM, Layout, Network)
- ‚úÖ **0 failing tests** —Å—Ä–µ–¥–∏ –Ω–æ–≤—ã—Ö (100% success rate)
- ‚úÖ **0 warnings** –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
- ‚ÑπÔ∏è CSS Phase 3 tests expected to fail (pseudo-–∫–ª–∞—Å—Å—ã –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)
- ‚ÑπÔ∏è HTTP/HTTPS tests –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã (—Ç—Ä–µ–±—É—é—Ç mock-—Å–µ—Ä–≤–µ—Ä)

### –°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å Week 1 —Å —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è CSS, ResourceLoader, –∏ JS –º–æ–¥—É–ª–µ–π.

---

**–î–∞—Ç–∞:** 2025-11-06  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~30 –º–∏–Ω—É—Ç  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
