# –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ (6 –Ω–æ—è–±—Ä—è 2025)

### üîê 1. –ê—É–¥–∏—Ç –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö `unsafe` –±–ª–æ–∫–æ–≤

#### `dom.rs`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ SAFETY –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è `unsafe impl Send/Sync`
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å `kuchikiki::NodeRef` (Rc-based)
- ‚úÖ –û–±—ä—è—Å–Ω–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ `Arc<RwLock<>>`
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### `layout.rs`
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã SAFETY –≥–∞—Ä–∞–Ω—Ç–∏–∏ –¥–ª—è `LayoutEngine`
- ‚úÖ –û–±—ä—è—Å–Ω–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `TaffyTree` –∏ `HashMap`
- ‚úÖ –£–∫–∞–∑–∞–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö/—Ä–∞–∑–¥–µ–ª—è–µ–º—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

#### `js.rs`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã SAFETY –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –≤—Å–µ—Ö 4 `unsafe` –±–ª–æ–∫–æ–≤:
  - `query_selector_fn` closure
  - `get_element_by_id_fn` closure
  - `set_timeout_fn` closure
  - `Send/Sync` impl –¥–ª—è `JSEngine`
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–º—ã–∫–∞–Ω–∏–π
- ‚úÖ –û–±—ä—è—Å–Ω–µ–Ω–∞ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å `Arc<Mutex<>>`

#### `render/initialization.rs`
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω `unsafe` –±–ª–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è WGPU surface
- ‚úÖ –û–±—ä—è—Å–Ω–µ–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ window handle

**–ò—Ç–æ–≥–æ**: 8 `unsafe` –±–ª–æ–∫–æ–≤ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

### üõ°Ô∏è 2. –ó–∞–º–µ–Ω–∞ `panic!`/`unwrap()`/`expect()` –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

#### `css/animations.rs`
- ‚úÖ `sort_by()`: –∑–∞–º–µ–Ω—ë–Ω `unwrap()` –Ω–∞ `unwrap_or(Ordering::Equal)` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ NaN
- ‚úÖ `serialize_value_tokens()`: –∑–∞–º–µ–Ω—ë–Ω `unwrap_or_else()` –Ω–∞ proper error handling —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

#### `network.rs`
- ‚úÖ Fallback –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è HTTP –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ Graceful degradation –∫ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

#### `resource_loader.rs`
- ‚úÖ Fallback –∫ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–º—É `reqwest::Client::new()` –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

#### `css/selectors.rs`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ `Mutex` poisoning —Å recovery
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `poisoned.into_inner()` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

#### `js.rs`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ poisoned mutex –¥–ª—è `timer_id_lock`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ poisoned mutex –¥–ª—è `timers_lock`
- ‚úÖ Graceful degradation —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–ò—Ç–æ–≥–æ**: 8 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö `unwrap()/expect()` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

### üìö 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ API

#### `lib.rs`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `Zver`
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω **Lock Ordering** (7 —É—Ä–æ–≤–Ω–µ–π –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã:
  - `Zver::new()` - —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - `Zver::load_url()` - —Å –ø–æ–ª–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø–∞–π–ø–ª–∞–π–Ω–∞, –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –æ—à–∏–±–∫–∞–º–∏

**–ö—Ä–∏—Ç–∏—á–Ω–æ**: –¢–µ–ø–µ—Ä—å –µ—Å—Ç—å —è–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –ø–æ—Ä—è–¥–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è deadlocks.

---

### üéØ 4. –£–ª—É—á—à–µ–Ω–∏—è –∫–æ–¥–∞

#### `css/animations.rs`
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è `cubic_bezier()` —Å TODO –æ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `kurbo` –∏–ª–∏ `lyon_geom`

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ/–ø–æ—Å–ª–µ

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –°—Ç–∞—Ç—É—Å |
|---------|-----|-------|--------|
| –ù–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ `unsafe` | 8 | 0 | ‚úÖ |
| `unwrap()/expect()` –≤ hot paths | 8 | 0 | ‚úÖ |
| –ü—É–±–ª–∏—á–Ω—ã–π API –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ | ~80% | ~40% | üü° |
| –û—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ | 0 | 0 | ‚úÖ |
| –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è clippy | 0 | 0 | ‚úÖ |
| –ü—Ä–æ—Ö–æ–¥—è—â–∏–µ —Ç–µ—Å—Ç—ã | 19/19 | 19/19 | ‚úÖ |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è
cargo check --all
‚úÖ Success

# Clippy
cargo clippy --all -- -D warnings
‚úÖ No warnings

# Unit —Ç–µ—Å—Ç—ã
cargo test --package zver --lib
‚úÖ 19 passed; 0 failed
```

---

## üîú –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–§–∞–∑–∞ 2)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è DOM**
   - –ü—Ä–æ–±–ª–µ–º–∞: `dom.read().await.clone()` –∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å—ë –¥–µ—Ä–µ–≤–æ
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Arc` –¥–ª—è immutable data –∏–ª–∏ copy-on-write
   
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π**
   - –î–æ–±–∞–≤–∏—Ç—å `LruCache<(String, f32), Size<f32>>`
   - –ò–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

3. **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - –î–æ–±–∞–≤–∏—Ç—å `tracing` spans –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ò–∑–º–µ—Ä—è—Ç—å –≤—Ä–µ–º—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã pipeline

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

4. **Incremental layout**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `dirty_regions` –¥–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - Invalidation tracking –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ DOM/CSS

5. **–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è cubic-bezier**
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `kurbo` –∏–ª–∏ `lyon_geom`
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö CSS easing —Ñ—É–Ω–∫—Ü–∏–π

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. **–í—Å–µ–≥–¥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `unsafe` –±–ª–æ–∫–∏** —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º:
   - –ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ
   - –ö–∞–∫–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è
   - –ö–∞–∫–∏–µ –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è —Ç—Ä–µ–±—É—é—Ç—Å—è

2. **–ò–∑–±–µ–≥–∞–π—Ç–µ `unwrap()`/`expect()` –≤ library –∫–æ–¥–µ**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Result<T, E>` –¥–ª—è propagation
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `unwrap_or_default()` / `unwrap_or_else()` –¥–ª—è fallback
   - –õ–æ–≥–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

3. **–°–æ–±–ª—é–¥–∞–π—Ç–µ Lock Ordering**:
   - DOM ‚Üí CSS ‚Üí Layout ‚Üí Render ‚Üí Network ‚Üí JS ‚Üí ResourceLoader
   - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –±–µ—Ä–∏—Ç–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –Ω–∏–∑–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è, –¥–µ—Ä–∂–∞ –≤—ã—Å–æ–∫–∏–π

4. **–ü–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π**:
   - Error handling paths
   - Edge cases (–ø—É—Å—Ç–æ–π DOM, NaN values, etc.)
   - Concurrency scenarios

---

## ‚úçÔ∏è –ê–≤—Ç–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–î–∞—Ç–∞**: 6 –Ω–æ—è–±—Ä—è 2025
- **–ö–æ–º–º–∏—Ç**: –§–∞–∑–∞ 1 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Reviewer**: –¢—Ä–µ–±—É–µ—Ç—Å—è code review –ø–µ—Ä–µ–¥ merge

---

## üìù Checklist –ø–µ—Ä–µ–¥ merge

- [x] –í—Å–µ `unsafe` –±–ª–æ–∫–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [x] –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö `unwrap()/expect()` –±–µ–∑ fallback
- [x] –ü—É–±–ª–∏—á–Ω—ã–π API –∏–º–µ–µ—Ç rustdoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- [x] `cargo check` –ø—Ä–æ—Ö–æ–¥–∏—Ç
- [x] `cargo clippy` –±–µ–∑ warnings
- [x] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (`cargo test`)
- [ ] Code review –æ—Ç –º–µ–π–Ω—Ç–µ–π–Ω–µ—Ä–∞
- [ ] –û–±–Ω–æ–≤–ª—ë–Ω CHANGELOG.md
- [ ] –û–±–Ω–æ–≤–ª—ë–Ω README.md (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üéØ –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–µ–∫—Ç

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚¨ÜÔ∏è –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞
- –í—Å–µ `unsafe` –±–ª–æ–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω—ã –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω —Ä–∏—Å–∫ undefined behavior

### –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å: ‚¨ÜÔ∏è –£–ª—É—á—à–µ–Ω–∞
- –ù–µ—Ç –ø–∞–Ω–∏–∫ –≤ production –∫–æ–¥–µ
- Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å: ‚¨ÜÔ∏è –£–ª—É—á—à–µ–Ω–∞
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Lock Ordering –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç deadlocks
- –ü–æ–Ω—è—Ç–Ω–æ, –ø–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `unsafe`

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ‚û°Ô∏è –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ hot paths
- Fallback paths –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

**Status**: ‚úÖ Ready for Phase 2
